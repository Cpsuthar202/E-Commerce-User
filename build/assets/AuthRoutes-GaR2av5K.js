import{u as P,r as u,c as $,j as e,B as x,O as U,a as H,i as J,b as V,d as F,s as C,e as N,T as v,f as A,I as q,g as j,h as K,k as W,R as Q,l as y,N as I}from"./index-ieQKGyNE.js";import{v as O,a as L,T as w,V as M,b as B,c as X,d as Y,P as Z,F as ee,C as te}from"./PasswordField-BTzZB48k.js";import{D as G}from"./Grow-Ccij_Z23.js";const re=()=>{const t=P(),[r,s]=u.useState(!1);return u.useEffect(()=>{$()?(console.log("jhgfd"),s(!0),t("/user",{replace:!0})):s(!1)},[t]),e.jsx(e.Fragment,{children:!r&&e.jsx(x,{sx:{display:"grid",placeItems:"center",flex:1,height:"70vh"},children:e.jsx(x,{sx:{minWidth:"max(20vw, 370px)",width:"370px",p:3,border:1,px:4,borderColor:"primary.main",borderRadius:2,textAlign:"center"},children:e.jsx(U,{})})})})};var k={},se=J;Object.defineProperty(k,"__esModule",{value:!0});var E=k.default=void 0;oe(u);var ae=se(H()),ne=e;function z(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,s=new WeakMap;return(z=function(a){return a?s:r})(t)}function oe(t,r){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var s=z(r);if(s&&s.has(t))return s.get(t);var a={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=n?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(a,o,i):a[o]=t[o]}return a.default=t,s&&s.set(t,a),a}E=k.default=(0,ae.default)((0,ne.jsx)("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google");const ie=t=>{const r={};let s=!0;const a=O(t.phone_number);a.isValid||(s=!1,r.phone_number=a.err.phone_number);const n=L(t.password);return n.isValid||(s=!1,r.password=n.err.password),{isValid:s,err:r}},le=()=>{const t=P(),r=V(),{loginDetailPreserve:s}=F(d=>d.auth),[a,n]=u.useState({phone_number:"",password:""}),[o,i]=u.useState({}),h={user:a,token:"qwertyuiopasdfghjklzxcvbnm"},m=d=>{const{name:p,value:S}=d.target;p==="phone_number"&&S.length>10||(n(R=>({...R,[p]:S})),i(R=>({...R,[p]:""})))},g=async d=>{d.preventDefault(),r(C(a));const p=ie(a);p.isValid?(N(h),t("/user",{replace:!0}),r(C(null))):i(p.err)},c=async()=>{r(C(a));const d=O(a.phone_number);d.isValid?t("/user/auth/verify_otp",{state:{userdata:a,action:"forgetpassword"}}):i(d.err)},l=async()=>{r(C(a)),t("/user/auth/registration")};return u.useEffect(()=>{s?n(s):console.log("No preserved login.")},[s]),{veriabls:{loginDetails:a,loginDetailsErr:o},methods:{handleLoginDetailsChange:m,handleSubmit:g,handleForgotPassword:c,handleRegistration:l}}},T=({title:t,subtitle:r,children:s})=>e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(v,{variant:"subtitle1",fontWeight:"bold",color:"primary.dark",children:[t,e.jsx(v,{variant:"body1",color:"primary.main",children:r})]}),s]}),de=()=>{const{veriabls:{loginDetails:t,loginDetailsErr:r},methods:{handleLoginDetailsChange:s,handleSubmit:a,handleForgotPassword:n,handleRegistration:o}}=le(),[i,h]=A.useState(!1),m=()=>h(g=>!g);return e.jsxs(T,{title:"Log in to E-Commerce",subtitle:"Enter your details below",children:[e.jsx("form",{onSubmit:a,children:e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(w,{variant:"standard",fullWidth:!0,autoFocus:!0,label:"Phone Number",name:"phone_number",type:"number",value:t.phone_number,onChange:s,error:!!r.phone_number,helperText:r.phone_number}),e.jsxs(x,{sx:{position:"relative"},children:[e.jsx(w,{variant:"standard",fullWidth:!0,type:i?"text":"password",label:"Password",name:"password",value:t.password,onChange:s,error:!!r.password,helperText:r.password}),e.jsx(q,{sx:{position:"absolute",right:8,top:18},onClick:m,children:i?e.jsx(M,{sx:{color:r.password?"error.main":"primary.main"}}):e.jsx(B,{sx:{color:r.password?"error.main":"primary.main"}})})]}),e.jsx(x,{sx:{display:"flex",justifyContent:"end",width:"100%"},children:e.jsx(j,{variant:"text",color:"primary",sx:{py:"1px"},onClick:n,children:"Forgot password ?"})}),e.jsx(j,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",children:"Log In"})]})}),e.jsx(G,{children:e.jsx(v,{variant:"body1",color:"primary.main",children:"Or, Login with"})}),e.jsx(j,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(E,{}),children:"Sign in with Google"}),e.jsxs(v,{variant:"body1",children:["Donâ€™t have an account?",e.jsx(v,{component:"span",variant:"body1",sx:{color:"primary.main",cursor:"pointer",ml:1},onClick:o,children:"Register here"})]})]})},ue=()=>{const t=P(),r=K(),s=V(),a=r.state.userdata,n=r.state.action,o=5,i={user:a,token:"qwertyuiopasdfghjklzxcvbnm"},[h,m]=u.useState({otp:"",password:""}),[g,c]=u.useState({}),[l,d]=u.useState(o),[p,S]=u.useState(!0);return u.useEffect(()=>{if(p&&l>0){const _=setInterval(()=>{d(f=>f-1)},1e3);return()=>{clearInterval(_)}}},[p,l]),{veriabls:{validationData:h,validationDataErr:g,userdata:a,actiontype:n,timer:l},methods:{handleChange:_=>{const{name:f,value:b}=_.target;f==="otp"&&b.length>6||(console.log({name:f,value:b}),m(D=>({...D,[f]:b})),c(D=>({...D,[f]:""})))},handleSubmit:async _=>{_.preventDefault();const f=X(h.otp);if(!f.isValid){c(b=>({...b,otp:f.err.otp??""}));return}if(n==="forgetpassword"){const b=L(h.password??"");if(!b.isValid){c(D=>({...D,password:b.err.password??""}));return}}N(i),t("/user",{replace:!0}),s(C(null))},handleResendOtp:async()=>{d(o),S(!0)}}}},ce=()=>{const{veriabls:{validationData:t,validationDataErr:r,userdata:s,actiontype:a,timer:n},methods:{handleChange:o,handleSubmit:i,handleResendOtp:h}}=ue(),[m,g]=A.useState(!1),c=()=>g(l=>!l);return e.jsx(T,{title:" Verification",subtitle:`Otp send Successfully on your Number ${s.phone_number}`,children:e.jsx("form",{onSubmit:i,children:e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(w,{autoFocus:!0,variant:"standard",label:"Otp",name:"otp",type:"number",value:t.otp,onChange:o,error:!!r.otp,helperText:r.otp,sx:{}}),a==="forgetpassword"&&e.jsxs(x,{sx:{position:"relative"},children:[e.jsx(w,{variant:"standard",fullWidth:!0,type:m?"text":"password",label:"New Password",name:"password",value:t.password,onChange:o,error:!!r.password,helperText:r.password,sx:{}}),e.jsx(q,{sx:{position:"absolute",right:8,top:18},onClick:c,children:m?e.jsx(M,{sx:{color:r.password?"error.main":"primary.main"}}):e.jsx(B,{sx:{color:r.password?"error.main":"primary.main"}})})]}),e.jsx(x,{sx:{display:"flex",justifyContent:"end"},children:n?e.jsxs(v,{variant:"body1",sx:{},children:["Resend OTP in ",n>0&&`${n} sec`]}):e.jsx(j,{type:"button",onClick:h,disabled:n>0,sx:{},children:"Resend OTP"})}),e.jsx(j,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",children:"Submit"})]})})})},pe=t=>{const r={};let s=!0;const a=Y(t.full_name);a.isValid||(s=!1,r.full_name=a.err.full_name);const n=O(t.phone_number);n.isValid||(s=!1,r.phone_number=n.err.phone_number);const o=L(t.password);return o.isValid||(s=!1,r.password=o.err.password),{isValid:s,err:r}},he=()=>{const t=P(),r=V(),{registerDetailPreserve:s}=F(c=>c.auth),[a,n]=u.useState({full_name:"",phone_number:"",password:""}),[o,i]=u.useState({}),h=c=>{const{name:l,value:d}=c.target;l==="phone_number"&&d.length>10||(n(p=>({...p,[l]:d})),i(p=>({...p,[l]:""})))},m=async c=>{c.preventDefault(),r(W(a));const l=pe(a);l.isValid?(console.log({registrationDetails:a}),t("/user/auth/verify_otp",{state:{userdata:a,action:"registration"}})):i(l.err)},g=async()=>{r(W(a)),t("/user/auth/login")};return u.useEffect(()=>{s?n(s):console.log("No preserved login.")},[s]),{veriabls:{registrationDetails:a,registrationDetailsErr:o},methods:{handleRegistrationDetailsChange:h,handleSubmit:m,handleLogin:g}}},me=()=>{const{veriabls:{registrationDetails:t,registrationDetailsErr:r},methods:{handleRegistrationDetailsChange:s,handleSubmit:a,handleLogin:n}}=he();return e.jsxs(T,{title:"Create an account",subtitle:"Enter your details to register.",children:[e.jsx("form",{onSubmit:a,children:e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(w,{autoFocus:!0,variant:"standard",fullWidth:!0,label:"Full Name",name:"full_name",value:t.full_name,onChange:s,error:!!r.full_name,helperText:r.full_name}),e.jsx(w,{variant:"standard",fullWidth:!0,label:"Phone Number",name:"phone_number",type:"number",inputProps:{maxLength:10,pattern:"\\d{10}"},value:t.phone_number,onChange:s,error:!!r.phone_number,helperText:r.phone_number}),e.jsx(Z,{value:t.password,onChange:s,error:!!r.password,helperText:r.password}),e.jsx(ee,{control:e.jsx(te,{required:!0,sx:{color:"primary.main"}}),label:"Agree to Terms",sx:{color:"primary.main"}}),e.jsx(j,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",sx:{},children:"Register"})]})}),e.jsx(G,{children:e.jsx(v,{variant:"body1",color:"primary.main",children:"Or, Register with"})}),e.jsx(j,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(E,{}),children:"Sign up with Google"}),e.jsxs(v,{children:["Already have an account?",e.jsx(v,{component:"span",sx:{color:"primary.main",cursor:"pointer",ml:1},onClick:n,children:"Log in here"})]})]})},je=()=>e.jsx(Q,{children:e.jsxs(y,{path:"/",element:e.jsx(re,{}),children:[e.jsx(y,{index:!0,element:e.jsx(I,{to:"/auth/login",replace:!0})}),e.jsx(y,{path:"login",element:e.jsx(de,{})}),e.jsx(y,{path:"registration",element:e.jsx(me,{})}),e.jsx(y,{path:"verify_otp",element:e.jsx(ce,{})}),e.jsx(y,{path:"*",element:e.jsx(I,{to:"/auth/login",replace:!0})})]})});export{je as default};
